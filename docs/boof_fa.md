<div dir="rtl">

# بوف

بوف یک موتور قالب ساده و سریع می باشد.

# معرفی

بوف یک انجین قالب ساده و سریع جهت استفاده در وب می باشد.جهت یکسان سازی در زبان های برنامه نویسی متفاوت .استاندارد فوق ارایه می گردد.تا طراحان فرانت فقط درگیر یک نوع استاندارد باشند


## خواص

قالب های مورد استفاده در بوف دارای خواص زیر هستند

- کدیک utf-8 بدون BOM  
- فایل با پسود html
- قالب از دو بخش تشکیل شده است
    - تگ
    - بخش ثابت
- اجزای تگ فقط با کد اسکی 
- امکان استفاده از یونیکد در رشته داخل تگ
- استفاده از کش کردن نتیجه کامپایل جهت بهبود پرفرمنس



# کلاس Boof

</div>

## Boof(path,debug_mode=false)

<div dir="rtl">

* path : مسیر جهت مشخص کردن مکان فایل های قالب,در دایرکتوری ".cache" فایل های کش ذخیره می گردند
* debug_mode : اگر این مقدار true باشد تگ های debug نیز اجرا می گردند

</div>

```php
$viewPath= dirname ( __FILE__ ).'/views' ;

$boof=new Boof($viewPath);
```
<div dir="rtl">

## متد

</div>

### set_path(path)

<div dir="rtl">

تغییر مسیر فایل های قالب

* path : مسیر جدید

</div>

```php
$viewPath= dirname ( __FILE__ ).'/views2' ;

$boof->set_path($viewPath);

```

### view(name,env=[]) 

<div dir="rtl">

رندر یک فایل و برگرداندن نتیجه

* name : نام فایل ,برای جداکنده دایرکتوری از نقطه استفاده می گردد 
* env : آرایه انجمنی از اطلاعات

</div>

```php
$boof->view('users.list',['title'=>'user list','items'=>$lists]);

```

### render(src,env=[]) 

<div dir="rtl">

رندر متن قالب و برگرداندن نتیجه

* src : متن قالب
* env : آرایه انجمنی از اطلاعات

</div>

```php
$boof->render('<h1>{{title}}</h1>',['title'=>'user list']);
```

### add_function(name, func)

<div dir="rtl">

اضافه کردن تابع خارجی به تمپلت

* name : نام تابع جهت استفاده در تمپلت
* func : عنصر قابل فراخوانی که مقدار رشته ریندر شده را برمی گرداند

</div>

```php
$boof->add_function("hello",function($name){return "hello ,".$name; });
echo $boof->render('{{hello "seyed rahim" }}');

```
<div dir="rtl">

# قالب

## برچسب یا تگ

برچسب یک تکه از کد می باشد که ما بین دو علامت {{ و }} قرار دارد و اجزای برچسب با فاصله از هم جدا می گرددند.بخش های تگ با فاصله یا اپراتور های که کارکتور ویژه هستند از هم جدا می گرددند 

## بخش ثابت

هر بخش قالب که تگ نباشد بخش ثابت می باشد .بخش های ثابت بدون محاسبه در خروجی ظاهر می گردد.

مثال

</div>

```
    hello , <b> {{ your.name }} </b>
    {{format "%s-%s-%s" 2019 1 1 }}

```

<div dir="rtl">

درصورت تعریف زیر

</div>

your.name = "Seyed Rahim Firouzi"

<div dir="rtl">

خروجی

</div>

```
    hello , <b> Seyed Rahim Firouzi </b>
    2019-1-1
```

<div dir="rtl">

## توضیحات
 
جهت نوشتن توضیحات درون تگ کافی است با // توضیحات را شروع کرد. توضیحات ادامه می یابد تا رسیدن به انتهای تگ . امکان نوشتن توضیحات چند خطی نیز وجود دارد

</div>

```
{{var name = "Seyed Rahim" // this is comment}}
{{// this is comment}}
{{//this is 
multi line comment}}
```

<div dir="rtl">

## فاصله پاک

اگر تگ با بعد از شروع با - و قبل از پایان با - باشد.فواصل قبل و بعد حذف می گردد.

</div>

```
123
     {{- var a = "line2" -}}  4
line3
don't remove  {{ "|" -}}    remove space
remove space  {{- "|" }}    don't remove
```

<div dir="rtl">

خروجی

</div>

```
1234
line3
don't remove  |remove space
remove space|    don't remove

```

<div dir="rtl">

## متغیر

مقادیر توسط متغیر ها به موتور قالب ارجاع داده شده یا در سطح قالب تعریف می گردند. نام متغیر از استاندارد زبان برنامه نویسی سی تبعیت می کند و برای دسترسی به آیتم های شی از نقطه استفاده می گردد.برای آرایه اینکس آیتم جهت اشاره استفاده می گردد.ضمنا متغیر های زبان داینامیک می باشند قابلیت تغیر نوع به صورت اتوماتیک دارند

چند مثال

</div>

```
ali  
object.name
array.2
layout.content
red5
```

<div dir="rtl">

## نوع متغیر

هر زبان برنامه نویسی نیاز به تعریف متغیر و در نتیجه تعریف نوع متغیر دارد.زبان تمپلت بوف نیز از این قاعده مستثنا نیست.انواع متغیر ها عبارتند از


### null

این نوع متغیر در اصل به معنای عدم تعریف یا عدم وجود می باشد و در عمل وجود نداشتن معنی می دهد.در تبدیل به رشته "" می شود

 </div>

```
{{var data = null }}
```

<div dir="rtl">

### bool

نوع بولین یک متغیر با مقدایر دزست یا غلط می باشد.و فقط این دو مقدار را می گیرند

- true
- false

</div>

```
{{ var data = true}}
```

<div dir="rtl">

### number

هر عدد صحیح یا اعشاری

مقادیر استاتیک

</div>

```
{{ var data = 12.34 }}
```

<div dir="rtl">

### string

یک رشته که می تواند متشکل از کارکتور های کنترلی و یونیکد باشد.جهت تعریف مقادیر یک رشته در "," قرار می گیرند.کارکتور های کنترلی عبارتند از

- \n  خط جدید
- \r اتمام خط
- \\" کارکتور "
- \\\ کارکتور \
- \t کارکتور تب

</div>

```
{{ var data = "this is a book \n این یک کتاب هست" }}
```

<div dir="rtl">

### array

مجمعه از مقادیر .جهت تعریف ارایه مقدادیر درون [,] وتوسط , از هم جدا می گردد

</div>

```
{{ var data=[1,2,3,4]}}
```
<div dir="rtl">

### object

لیست از اجرای کلیدومقدار . جهت تعریف لیست درون {,} می باشد که توسط , ازهم جدا شده و کلید ها و مقدار ها نیز توسط : از هم جدا می گرددند

</div>

```
{{ var obj ={ name:"rahim", books:20  } }}
```
<div dir="rtl">

مثال

</div>

```
{{ null }} 
{{ true }} 
{{ 12.34 }}
{{ "hellow \t world" }}
{{ [ false , 123 , "hello" ] }}
{{ {color : "blue" , age : 22}  }}
```

<div dir="rtl">

## مقادیر دروغین

جهت امکان استفاده از انواع متغیر ها در دستورات کنترلی می بایست روشی جهت تبدیل انواع متغیر ها به متغیز بولین باشد.تمام مقادیر صحیح هستند مگر جدول زیر 

جدول مقادیر دروغین


|  type |   value    |
|:-----:|:----------:|
|null   |null        |
|bool   |false       |
|number |0           |
|string |""          |
|array  |empty array |
|object |empty object|


## دستورات کنترلی

### if

جهت تعریف شرط در زمان اجرا از دستور فوق استفاده می گردد.دو روش استفاده وجود دارد

- با اپراتورها
- بدون اپراتورها


ساختار کد

</div>

```
{{ if ...}}
 بخش که وقتی شرط صحیح باشد اجرا می گردد
{{ else }}
 بخش که وقتی شرط نادرست باشد اجرا می گردد
{{end}}
```

<div dir="rtl">

بخش نادرست قابل حذف شدن می باشد

</div>

```
{{ if ...}}
 بخش که وقتی شرط صحیح باشد اجرا می گردد
{{end}}
```

<div dir="rtl">

#### با اپراتور ها

در این روش از اپراتورهای زیر جهت تعریف شرط استفاده می گردد

</div>

```
{{ if var1 operator var2}}
 بخش که وقتی شرط صحیح باشد اجرا می گردد
{{ else }}
 بخش که وقتی شرط نادرست باشد اجرا می گردد
{{end}}
```

<div dir="rtl">

لیست اپراتورها
 1. (==) مساوی
 2. (!=) برابر نبودن
 3. (>) بزرگتر
 4. (<) کوچکتر
 5. (>=) بزرگتر و مساوی
 6. (<=) کوچکتر و مساوی
 7. (in) وجود مقدار اول در آیتم های دوم را چک می کند

مثال

</div>

```
{{ var garde = 20 }}
{{ if grade >= 3 }}
   this is best grade
{{else}}
    this is bad grade
{{end}}
```

<div dir="rtl">

خروجی

</div>

```
   this is best grade
```

<div dir="rtl">

#### بدون اپراتور

در این روش فقط حالت مقادیر چک می شود.در صورت صحیح بودن بلوک شرط اجرا می گردد.جدول مقادیر دروغین در این محل کاربرد فراوان دارد.

</div>

```
{{ if var1 }}
 بخش که وقتی شرط صحیح باشد اجرا می گردد
{{ else }}
 بخش که وقتی شرط نادرست باشد اجرا می گردد
{{end}}

```

<div dir="rtl">

مثال

</div>

```
{{var holiday = true}}
{{ if holiday }} chose best day,{{end}}
```

<div dir="rtl">

خروجی

</div>

```
 chose best day,
```
<div dir="rtl">

### for 

جهت تعریف حلفه در سطح قالب کاربرد دارد. هر بار برای آیتم های ارایه یا شی ارجاعی مقادیر را در متغیر اول قرار داده و بلوک حلقه اجرا می گردد.

</div>

```
{{ for var1 in array}}
  بلوک که هر بار اجرا می گردد و آیتم های ارایه در متغیر می باشد
{{else}}
 در صورت دروغین بودن ارایه ارجاعی این بخش اجرا می گردد
{{end}}
```
<div dir="rtl">

ضمنا درون حلقه متغیر های زیر دارای مقدار می باشند


| متغیر  |             توضیح           |
|:---------:|:-------------------------:|
|for.index  |  تعداد دوره اجرا شده تا کنون حلقه.از صفر شروع می شود|
|for.key    | ایندس آرایه یا ابجکت        |
|for.first  | در آیتم اول مقدار درست می گیرد     |
|for.last   | در آیتم آخر مقدار درست می گیرد      |


** index آیتم اول برابر با صفر است

</div>

```
{{ var list = [1,2,3,4] }}
{{ for ele in list }}
   {{ for.index + 1 }} - {{ ele }} <br/>
{{ end }}
```

<div dir="rtl">

خروجی

</div>


```
   1 - 1 <br/>
   2 - 2 <br/>
   3 - 3 <br/>
   4 - 4 <br/>
```

<div dir="rtl">

### debug

در صورتی موتور قالب در وضعیت عیب یابی یا دیباگ باشد بلوک موجود اجرا می گردد.در حالت معمول این قسمت اجرا نمی گردد

</div>

```
{{debug}}
    {{var a = 22}}
    hello world
    ...

{{end}
```

<div dir="rtl">

### macro

جهت تعریف یک تابع در درون قالب کاربرد دارد.تابع به وجود آمده قابلیت ریکرسیو را دارا بوده و کاملا نسبت به متغیر هی خارج تابع سند باکس می باشد

</div>

```
{{macro macroname param1 param2 ... }}
   قالب تابع که فقط از پارامتر ها استفاده می کند
{{end}}

```
<div dir="rtl">

- macroname نام ماکرو
- param1 پارامتر اول
- param1 پارامتر دوم
- ...



جهت فراخوانی

</div>

```
{{macroname param1 param2 ...}}
```

<div dir="rtl">

- macroname نام ماکرو
- param1 پارامتر اول
- param1 پارامتر دوم
- ...


مثال

</div>

```
{{macro call a b}}
   {{a}} call {{b}} for work <br/>
{{end}}

{{ say "seyed rahim" "ali"}}
{{ say "bob" "alice"}}

```

<div dir="rtl">

خروجی

</div>

```

seyed rahim call ali for work <br/>
bob call alice for work <br/> 
```
<div dir="rtl">

## آیتم ها

### var

جهت مقدار دهی به متغیر ها استفاده می گردد

</div>

```
var varableName = data
```

<div dir="rtl">

- varableName نام متغیر
- data مقدار جهت قرار دادن در متغیر 

هیچ مقداری را برنمی گرداند

مقادیر سمت راست تساوی می تواند موارد زیر باشد و بهجای چاپ شدن در متغیر قرار می گیرند

1. مقادیر استاتیک
2. مقادیر محاصباتی
3. بولتین های موتور قالب
4. توابع نیتیو 
5. ماکرو

</div>

```
{{ var name = "salam"}}
{{ var age = 5 + 1 }}
{{ var day = ? ligth  true false }}
{{ var html = ! "<>&" }}
{{ var data = userFunc p1 p2 p3 }}
{{ var form = macroName p1 p2 p3 }}
```

<div dir="rtl">

### مقادیر محاصباتی

محاصبات ساده ریاضی . اولویت بندی فقط ترتیب محاصبات می باشد نه اولویت های ریاضی.محاصبه در خروجی چاپ می گردد


1. (+) برابر با اپراتور ریاضی +
2. (-) برابر با اپراتور ریاضی  -
3. (/) برابر با اپراتور ریاضی  /
4. (*) برابر با اپراتور ریاضی  *
5. (%) برابر با اپراتور باقیمانده ریاضی
6. (~) چسباندن دو به فرم رشته.در صورتی که مقادیر رشته نباشند به رشته تبدیل گردد

</div>

```
{{ 1 + 2 * 3}}
{{5 % 2}}
{{ "hello " ~ "world"}}
```

<div dir="rtl">

خروجی

</div>
 
```
9
1
hello world
```

<div dir="rtl">

### بولتین

چند تابع در ساختار موتور قالب به صورت پیش فرض تعریف گردیده است گه عبارتند از


1. ? 
2. !
3. enum
4. %
5. format
6. layout
7. import

جهت فراخوانی بولتین ها نام بولتین وبعد از آن پارامترها به فاصله به نوشته می شود

#### ?

جهت استفاده ساده تر از شرط و نتیجه در خروجی چاپ می گردد

</div>

```
{{ ? condtion truePart FalsePart }}
```

<div dir="rtl">

- condtion مقدار بولین  جهت شرط
- truePart مقدار چاپ شده در خروجی در صورت درستی شرط
- FalsePart مقدار چاپ شده در خروجی در صورت نادرستی شرط


مثال

</div>

```
{{ ?  true  "this is true"  "this is false"}}
```

<div dir="rtl">

خروجی

</div>

```
this is true
```

<div dir="rtl">

#### !

برای کد دردن به اچ دی ام ال

</div>

```
{{ ! data }}
```

<div dir="rtl">

- data مقداری که می بایست کد شود

مقدار کد شده در خروجی چاپ می شود

#### enum 

برای تبدیل عدد به یک کیس خاص

</div>

```
enum number caseZero caseOne caseTwo ...
```

<div dir="rtl">

- number عدد جهت بررسی
- caseZero در صورت صفر بودن عدد بررسی این مقدار چاپ می شود
- caseOne در صورت یک بودن عدد بررسی این مقدار چاپ می شود
- caseTwo در صورت دو بودن عدد بررسی این مقدار چاپ می شود
- ...



#### %

برای کد کردن به یو ار ال

</div>

```
{{ % data }}
```

<div dir="rtl">

- data مقداری که می بایست کد شود

مقدار کد شده در خروجی چاپ می شود


#### format 

برای تولید یک رشته به فرمت خاص همانند زبان برنامه نویسی سی

سویچ های فرمت
1. %s رشته بدون هیچ نوع کدیک
2. %h رشته با کدیک اچ تی ام ال
3. %u رشته با کدیک یو ار ال

</div>

```
format formatedString p1 p2 p3 ...
```

<div dir="rtl">

- formatedString رشته فرمت دارای سویچ های 
- p1 متغیر اول
- p2 متغیر دوم
- p3 متغیر سوم
- ...

رشته جایگزین شده در فرمت چاپ می گردد


مثال

</div>

```
{{ ? true "true" "false" }}
{{ ! "go->" }} 
{{ enum 2 zero first second }}
{{ % "a b"}}
{{ format "%s:%s:%s %h" 12 24 30  ">"}}

```

<div dir="rtl">

خروجی

</div>

```
true
go-&gt;
second
a+b
12:24:30 &gt;
```

<div dir="rtl">

#### import

جهت ورود یک فایل قالب دیگر در قالب موجود

</div>

```
{{import "header"}}
```

<div dir="rtl">

نکات مهم 

1. استفاده از نقطه جهت جدا سازی دایرکتوری فایل ها
2. نام بدون  پسوند فایل
3. دستور فوق در زمان اجرا انجام می شود نه در زمان کامپایل

#### layout

جهت استفاده از فایل لایوت برای قالب موجود.خروجی قالب موجود را در فایل لایوت قرار می دهد و خروجی فایل لایوت را برمی گرداند.

1. مقادیر خروجی فوق در متغییر "content" قرار می گیرد
2. جهت تعریف دیگر مقادیر فایل لایوت مقادیر شی "layout" می بایست تغیر کند
    - title in layout -> layout.title in main template
3. در صورت مقداردهی به layout.content دیگر از خروجی فایل حهت لایوت استفاده نمی گردد
4. دستور فوق برابر با مقدار دهی به layout.layout می باشد


# مثال

</div>

lay.html

```
<div>{{title}}</div>
<div>
{{content}}
</div>
```

header.html

```
<h1>header</h1>
```

main.html

```
{{layout "lay" //equal var layout.layout = "lay"}}
{{import "header"}}
{{var layout.title = "hello"}}
seyed rahim
```

خروجی فایل main

```
<div>hello</div>
<div>
<h1>header</h1>
seyed rahim
</div>
```

<div dir="rtl">

### توابع نیتیو
 
توابعی که از خارج از موتور قالب به آن معرفی می گردد می باشند روش فراخوانی همانند ماکرو می باشد 

جهت فراخوانی

</div>

```
{{fun param1 param2 ...}}
```

<div dir="rtl">

- fun  نام تابع نیتیو
- param1 پارامتر اول
- param1 پارامتر دوم
- ...



### متغیر

در صورت قرار نام یک  متغیر یایک مقدار استاتیک در یک تگ مقادیر آن در خروجی بدون هیج فاصله چاپ می گردد

مثال

</div>

```
{{ "hello,world"}}
```

<div dir="rtl">

خروجی

</div>

```
hello,world
```